<svelte:head>
	<title>Devtools Training</title>
</svelte:head>

<Score/>
<Nav/>

<main class="content">
	<ConsoleOpenPanel id="consoleopenpanel" />
	<ConsoleBrowserError id="consolebrowsererror" />
	<ConsoleSettings id="consolesettings" />
	<ConsoleAPI id="consoleapi" />
	<ConsoleDevError id="consoledeverror" />
</main>

<script>
	import localForage from "localforage";

	export default {
		components: {
			Score: '../components/Score.html',
			Nav: '../components/Nav.html',
			ConsoleOpenPanel: '../components/console/OpenPanel.html',
			ConsoleBrowserError: '../components/console/BrowserError.html',
			ConsoleSettings: '../components/console/Settings.html',
			ConsoleAPI: '../components/console/Api.html',
			ConsoleDevError: '../components/console/DevError.html',
		},

		preload({ params, query }) {
			return this.fetch(`/articles.json`).then(r => r.json()).then(articles => {
				return { articles };
			});
		},

		oncreate() {
			const _this = this;

			const articles = this.get().articles;

			localForage.getItem('done', function (err, value) {
				if (value) {
					_this.store.set({
						done: value
					});
				}
			});

			this.store.set({
				articles
			});
		}
	};
</script>